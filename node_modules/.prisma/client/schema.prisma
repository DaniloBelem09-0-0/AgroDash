generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// --- TABELAS ---

model User {
  id        String   @id
  name      String
  email     String   @unique
  password  String   // Hash da senha
  createdAt DateTime @default(now())

  // Relacionamento: Um usuário tem vários sensores
  sensors   VirtualSensor[]

  @@map("users")
}

model VirtualSensor {
  id        String   @id
  name      String
  lat       Float
  lon       Float
  active    Boolean  @default(true)
  
  userId    String
  user      User     @relation(fields: [userId], references: [id])

  readings  SensorReading[]

  @@map("virtual_sensors")
}

// Tabela Time-Series (Leituras)
model SensorReading {
  id        String   @id
  value     Float
  type      String   // 'temperature', 'rain', 'humidity'
  readAt    DateTime @default(now())

  sensorId  String
  sensor    VirtualSensor @relation(fields: [sensorId], references: [id])

  @@map("sensor_readings")
}